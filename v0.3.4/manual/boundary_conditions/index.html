<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Boundary Conditions · Ferrite.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Ferrite.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../fe_intro/">Introduction to FEM</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../degrees_of_freedom/">Degrees of Freedom</a></li><li><a class="tocitem" href="../assembly/">Assembly</a></li><li class="is-active"><a class="tocitem" href>Boundary Conditions</a><ul class="internal"><li><a class="tocitem" href="#Dirichlet-Boundary-Conditions"><span>Dirichlet Boundary Conditions</span></a></li><li><a class="tocitem" href="#Neumann-Boundary-Conditions"><span>Neumann Boundary Conditions</span></a></li><li><a class="tocitem" href="#Periodic-boundary-conditions"><span>Periodic boundary conditions</span></a></li></ul></li><li><a class="tocitem" href="../constraints/">Constraints</a></li><li><a class="tocitem" href="../grid/">Grid</a></li><li><a class="tocitem" href="../export/">Export</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/heat_equation/">Heat Equation</a></li><li><a class="tocitem" href="../../examples/postprocessing/">Postprocessing</a></li><li><a class="tocitem" href="../../examples/helmholtz/">Helmholtz equation</a></li><li><a class="tocitem" href="../../examples/incompressible_elasticity/">Incompressible Elasticity</a></li><li><a class="tocitem" href="../../examples/hyperelasticity/">Hyperelasticity</a></li><li><a class="tocitem" href="../../examples/threaded_assembly/">Threaded Assembly</a></li><li><a class="tocitem" href="../../examples/plasticity/">von Mises plasticity</a></li><li><a class="tocitem" href="../../examples/transient_heat_equation/">Time Dependent Problems</a></li><li><a class="tocitem" href="../../examples/landau/">Ginzburg-Landau model energy minimization</a></li><li><a class="tocitem" href="../../examples/linear_shell/">Linear shell</a></li><li><a class="tocitem" href="../../examples/quasi_incompressible_hyperelasticity/">Nearly Incompressible Hyperelasticity</a></li><li><a class="tocitem" href="../../examples/ns_vs_diffeq/">Incompressible Navier-Stokes Equations via DifferentialEquations.jl</a></li><li><a class="tocitem" href="../../examples/computational_homogenization/">Computational homogenization</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../reference/quadrature/">Quadrature</a></li><li><a class="tocitem" href="../../reference/interpolations/">Interpolation</a></li><li><a class="tocitem" href="../../reference/fevalues/">FEValues</a></li><li><a class="tocitem" href="../../reference/dofhandler/">DofHandler</a></li><li><a class="tocitem" href="../../reference/assembly/">Assembly</a></li><li><a class="tocitem" href="../../reference/boundary_conditions/">Boundary Conditions</a></li><li><a class="tocitem" href="../../reference/grid/">Grid &amp; AbstractGrid</a></li><li><a class="tocitem" href="../../reference/export/">Postprocessing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Boundary Conditions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Boundary Conditions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/master/docs/src/manual/boundary_conditions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Boundary-Conditions"><a class="docs-heading-anchor" href="#Boundary-Conditions">Boundary Conditions</a><a id="Boundary-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-Conditions" title="Permalink"></a></h1><p>Every PDE is accompanied with boundary conditions. There are different types of boundary conditions, and they need to be handled in different ways. Below we discuss how to handle the most common ones, Dirichlet and Neumann boundary conditions, and how to do it <code>Ferrite</code>.</p><h2 id="Dirichlet-Boundary-Conditions"><a class="docs-heading-anchor" href="#Dirichlet-Boundary-Conditions">Dirichlet Boundary Conditions</a><a id="Dirichlet-Boundary-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Dirichlet-Boundary-Conditions" title="Permalink"></a></h2><p>At a Dirichlet boundary the solution is prescribed to a given value. For the discrete FE-solution this means that there are some degrees of freedom that are fixed. To be able to tell which degrees of freedom we should constrain we need the <code>DofHandler</code>.</p><pre><code class="language-julia hljs">ch = ConstraintHandler(dh)</code></pre><p>TBW</p><div class="admonition is-info"><header class="admonition-header">Examples</header><div class="admonition-body"><p>The following commented examples makes use of Dirichlet boundary conditions:</p><ul><li><a href="../../examples/heat_equation/#Heat-Equation">Heat Equation</a></li><li>TODO</li></ul></div></div><h2 id="Neumann-Boundary-Conditions"><a class="docs-heading-anchor" href="#Neumann-Boundary-Conditions">Neumann Boundary Conditions</a><a id="Neumann-Boundary-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Neumann-Boundary-Conditions" title="Permalink"></a></h2><p>At the Neumann part of the boundary we know something about the gradient of the solution.</p><p>As an example, the following code snippet can be included in the element routine, to evaluate the boundary integral:</p><pre><code class="language-julia hljs">for face in 1:nfaces(cell)
    if onboundary(cell, face) &amp;&amp; (cellid(cell), face) ∈ getfaceset(grid, &quot;Neumann Boundary&quot;)
        reinit!(facevalues, cell, face)
        for q_point in 1:getnquadpoints(facevalues)
            dΓ = getdetJdV(facevalues, q_point)
            for i in 1:getnbasefunctions(facevalues)
                δu = shape_value(facevalues, q_point, i)
                fe[i] += δu * b * dΓ
            end
        end
    end
end</code></pre><p>We start by looping over all the faces of the cell, next we have to check if this particular face is located on the boundary, and then also check that the face is located on our face-set called <code>&quot;Neumann Boundary&quot;</code>. If we have determined that the current face is indeed on the boundary and in our faceset, then we reinitialize <code>facevalues</code> for this face, using <a href="../../reference/fevalues/#Ferrite.reinit!"><code>reinit!</code></a>. When <code>reinit!</code>ing <code>facevalues</code> we also need to give the face number in addition to the cell. Next we simply loop over the quadrature points of the face, and then loop over all the test functions and assemble the contribution to the force vector.</p><div class="admonition is-info"><header class="admonition-header">Examples</header><div class="admonition-body"><p>The following commented examples makes use of Neumann boundary conditions:</p><ul><li>TODO</li></ul></div></div><h2 id="Periodic-boundary-conditions"><a class="docs-heading-anchor" href="#Periodic-boundary-conditions">Periodic boundary conditions</a><a id="Periodic-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Periodic-boundary-conditions" title="Permalink"></a></h2><p>Periodic boundary conditions ensure that the solution is periodic. This is common in multiscale modeling and computational homogenization when solving the finite element problem on the subscale. The subscale problem is then solved on a Representative Volume Element (RVE), or Statistical Volume Element (SVE), typically on a cubical domain, to find the fluctuation field <span>$u^{\mu}$</span> with a known macroscopic field <span>$u^{\mathrm{M}}$</span> as input. Periodic boundary conditions is one choice for such a setup, and ensures that the fluctuation is periodic.</p><p>A periodic Dirichlet boundary condition is described by</p><p class="math-container">\[\llbracket u \rrbracket = 0 \quad \mathrm{on} \quad \Gamma^{+},\]</p><p>where <span>$\llbracket \bullet \rrbracket := \bullet(x^{+}) - \bullet(x^{-})$</span> is the &quot;jump operator&quot;, and <span>$x^{+}$</span> and <span>$x^{-}$</span> coordinates on the image, <span>$\Gamma^{+}$</span>, and mirror, <span>$\Gamma^{-}$</span>, part of the boundary. Thus, this condition ensure that the jump, or difference, in the solution between the image and mirror boundary is the zero – the solution becomes periodic.</p><p>In <code>Ferrite</code> periodic Dirichlet boundary conditions can be added to the <code>ConstraintHandler</code> by adding a <code>PeriodicDirichlet</code> as follows:</p><pre><code class="language-julia hljs"># Create a constraint handler from the dof handler
ch = ConstraintHandler(dofhandler)

# Construct the periodic constraint for field :u
pdbc = PeriodicDirichlet(:u, [&quot;left&quot; =&gt; &quot;right&quot;, &quot;bottom&quot; =&gt; &quot;top&quot;])

# Add the constraint to the constraint handler
add!(ch, pdbc)

# If no more constraints should be added we can close
close!(ch)</code></pre><p>This adds a constraint on the field <code>:u</code> that ensures that the solution on the mirror boundary face sets (<code>&quot;left&quot;</code> and <code>&quot;bottom&quot;</code>) mirrors the solution on the image boundary face sets (<code>&quot;right&quot;</code> and <code>&quot;top&quot;</code>).</p><p>The constraint is imposed in a strong sense, so note that this requires (i) a periodic domain and (ii) a periodic mesh such that corresponding element sides can be found on the image and mirror parts of the boundary, respectively.</p><h4 id="Heterogeneous-&quot;periodic&quot;-constraint"><a class="docs-heading-anchor" href="#Heterogeneous-&quot;periodic&quot;-constraint">Heterogeneous &quot;periodic&quot; constraint</a><a id="Heterogeneous-&quot;periodic&quot;-constraint-1"></a><a class="docs-heading-anchor-permalink" href="#Heterogeneous-&quot;periodic&quot;-constraint" title="Permalink"></a></h4><p>Instead of solving the just the fluctuation field on the RVE it is possible to solve for the full field. For example, in the multi-scale setup described above, where the solution in the RVE is constructed as</p><p class="math-container">\[u = u^{\mathrm{M}} + u^{\mu},\]</p><p>it is possible to solve for <span>$u$</span> rather than just <span>$u^{\mu}$</span>. In order to still ensure a periodic fluctuation the constraint can instead be described by</p><p class="math-container">\[\llbracket u \rrbracket = \llbracket u^{\mathrm{M}} \rrbracket
\quad \mathrm{on} \quad \Gamma^{+}.\]</p><p>The <code>PeriodicDirichlet</code> constraint can be used for this too, although the constraint in this case is not technically periodic as applied to <span>$u$</span>, but ensures periodicity on the fluctuation <span>$u^{\mu}$</span>. This is done by passing a function to <code>PeriodicDirichlet</code>, similar to <code>Dirichlet</code>, which, given the coordinate <span>$\boldsymbol{x}$</span> and time <code>t</code>, computes the prescribed values of <span>$u^{\mathrm{M}}$</span> on the boundary.</p><p>As an example, consider the case where the macroscopic solution is constructed as follows (first order homogenization):</p><p class="math-container">\[u^{\mathrm{M}} = \bar{u} + \boldsymbol{\nabla} \bar{u} \cdot [\boldsymbol{x} - \bar{\boldsymbol{x}}],\]</p><p>where <span>$\bar{u}$</span> is the homogenized field from the macroscale, and <span>$\bar{\boldsymbol{x}}$</span> the centre coordinate of the RVE. This corresponds to the following constraint in <code>Ferrite</code>:</p><pre><code class="language-julia hljs"># Construct the &quot;periodic&quot; constraint
pdbc = PeriodicDirichlet(
    :u,
    [&quot;left&quot; =&gt; &quot;right&quot;, &quot;bottom&quot; =&gt; &quot;top&quot;],
    (x, t) -&gt; ū + ∇ū ⋅ (x - x̄)
)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../assembly/">« Assembly</a><a class="docs-footer-nextpage" href="../constraints/">Constraints »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.13 on <span class="colophon-date" title="Saturday 26 February 2022 15:27">Saturday 26 February 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
