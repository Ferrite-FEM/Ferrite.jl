<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Interpolations · Ferrite.jl</title><meta name="title" content="Interpolations · Ferrite.jl"/><meta property="og:title" content="Interpolations · Ferrite.jl"/><meta property="twitter:title" content="Interpolations · Ferrite.jl"/><meta name="description" content="Documentation for Ferrite.jl."/><meta property="og:description" content="Documentation for Ferrite.jl."/><meta property="twitter:description" content="Documentation for Ferrite.jl."/><meta property="og:url" content="https://ferrite-fem.github.io/Ferrite.jl/stable/devdocs/interpolations/"/><meta property="twitter:url" content="https://ferrite-fem.github.io/Ferrite.jl/stable/devdocs/interpolations/"/><link rel="canonical" href="https://ferrite-fem.github.io/Ferrite.jl/stable/devdocs/interpolations/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Ferrite.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Ferrite.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/">Tutorials overview</a></li><li><a class="tocitem" href="../../tutorials/heat_equation/">Heat equation</a></li><li><a class="tocitem" href="../../tutorials/linear_elasticity/">Linear elasticity</a></li><li><a class="tocitem" href="../../tutorials/incompressible_elasticity/">Incompressible elasticity</a></li><li><a class="tocitem" href="../../tutorials/hyperelasticity/">Hyperelasticity</a></li><li><a class="tocitem" href="../../tutorials/plasticity/">Von Mises plasticity</a></li><li><a class="tocitem" href="../../tutorials/transient_heat_equation/">Transient heat equation</a></li><li><a class="tocitem" href="../../tutorials/computational_homogenization/">Computational homogenization</a></li><li><a class="tocitem" href="../../tutorials/stokes-flow/">Stokes flow</a></li><li><a class="tocitem" href="../../tutorials/porous_media/">Porous media</a></li><li><a class="tocitem" href="../../tutorials/ns_vs_diffeq/">Incompressible Navier-Stokes equations via DifferentialEquations.jl</a></li><li><a class="tocitem" href="../../tutorials/reactive_surface/">Reactive surface</a></li><li><a class="tocitem" href="../../tutorials/linear_shell/">Linear shell</a></li><li><a class="tocitem" href="../../tutorials/dg_heat_equation/">Discontinuous Galerkin heat equation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Topic guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../topics/">Topic guide overview</a></li><li><a class="tocitem" href="../../topics/fe_intro/">Introduction to FEM</a></li><li><a class="tocitem" href="../../topics/reference_shapes/">Reference shapes</a></li><li><a class="tocitem" href="../../topics/FEValues/">FEValues</a></li><li><a class="tocitem" href="../../topics/degrees_of_freedom/">Degrees of freedom</a></li><li><a class="tocitem" href="../../topics/sparse_matrix/">Sparsity pattern and sparse matrices</a></li><li><a class="tocitem" href="../../topics/assembly/">Assembly</a></li><li><a class="tocitem" href="../../topics/boundary_conditions/">Boundary and initial conditions</a></li><li><a class="tocitem" href="../../topics/constraints/">Affine constraints</a></li><li><a class="tocitem" href="../../topics/grid/">Grid</a></li><li><a class="tocitem" href="../../topics/export/">Export</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">API reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/">Reference overview</a></li><li><a class="tocitem" href="../../reference/quadrature/">Quadrature</a></li><li><a class="tocitem" href="../../reference/interpolations/">Interpolation</a></li><li><a class="tocitem" href="../../reference/fevalues/">FEValues</a></li><li><a class="tocitem" href="../../reference/dofhandler/">Degrees of freedom</a></li><li><a class="tocitem" href="../../reference/sparsity_pattern/">Sparsity pattern and sparse matrices</a></li><li><a class="tocitem" href="../../reference/assembly/">Assembly</a></li><li><a class="tocitem" href="../../reference/boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../../reference/grid/">Grid &amp; AbstractGrid</a></li><li><a class="tocitem" href="../../reference/export/">Postprocessing</a></li><li><a class="tocitem" href="../../reference/utils/">Development utility functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">How-to guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../howto/">How-to guide overview</a></li><li><a class="tocitem" href="../../howto/postprocessing/">Post processing and visualization</a></li><li><a class="tocitem" href="../../howto/threaded_assembly/">Multi-threaded assembly</a></li></ul></li><br><li><a class="tocitem" href="../../gallery/">Code gallery</a></li><li><a class="tocitem" href="../">Developer documentation</a></li><li><a class="tocitem" href="../../cited-literature/">Cited literature</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Interpolations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Interpolations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Ferrite-FEM/Ferrite.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/master/docs/src/devdocs/interpolations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="devdocs-interpolations"><a class="docs-heading-anchor" href="#devdocs-interpolations">Interpolations</a><a id="devdocs-interpolations-1"></a><a class="docs-heading-anchor-permalink" href="#devdocs-interpolations" title="Permalink"></a></h1><p>All <code>Interpolation</code>s should subtype <code>Interpolation{shape, order}</code>, where <code>shape &lt;: AbstractRefShape</code> is the reference shape for which the interpolation is defined and <a href="../../reference/interpolations/#Ferrite.getorder"><code>order</code></a> is the characteristic interpolation order. The <a href="#devdocs-howto_new-interpolation">how-to at bottom of this page</a> describes how to implement a new interpolation.</p><h2 id="Methods-to-be-implemented-for-a-new-interpolation"><a class="docs-heading-anchor" href="#Methods-to-be-implemented-for-a-new-interpolation">Methods to be implemented for a new interpolation</a><a id="Methods-to-be-implemented-for-a-new-interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#Methods-to-be-implemented-for-a-new-interpolation" title="Permalink"></a></h2><h3 id="Always"><a class="docs-heading-anchor" href="#Always">Always</a><a id="Always-1"></a><a class="docs-heading-anchor-permalink" href="#Always" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.reference_shape_value-Tuple{Interpolation, Vec, Int64}" href="#Ferrite.reference_shape_value-Tuple{Interpolation, Vec, Int64}"><code>Ferrite.reference_shape_value</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reference_shape_value(ip::Interpolation, ξ::Vec, i::Int)</code></pre><p>Evaluate the value of the <code>i</code>th shape function of the interpolation <code>ip</code> at a point <code>ξ</code> on the reference element. The index <code>i</code> must match the index in <a href="../elements/#Ferrite.vertices-Tuple{Ferrite.AbstractCell}"><code>vertices(::Interpolation)</code></a>, <a href="../elements/#Ferrite.faces-Tuple{Ferrite.AbstractCell}"><code>faces(::Interpolation)</code></a> and <a href="../elements/#Ferrite.edges-Tuple{Ferrite.AbstractCell}"><code>edges(::Interpolation)</code></a>.</p><p>For nodal interpolations the indices also must match the indices of <a href="#Ferrite.reference_coordinates-Tuple{Interpolation}"><code>reference_coordinates(::Interpolation)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L246-L256">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.reference_coordinates-Tuple{Interpolation}" href="#Ferrite.reference_coordinates-Tuple{Interpolation}"><code>Ferrite.reference_coordinates</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reference_coordinates(ip::Interpolation)</code></pre><p>Returns a vector of coordinates with length <a href="#Ferrite.getnbasefunctions-Tuple{Interpolation}"><code>getnbasefunctions(::Interpolation)</code></a> and indices corresponding to the indices of a dof in <a href="../elements/#Ferrite.vertices-Tuple{Ferrite.AbstractCell}"><code>vertices</code></a>, <a href="../elements/#Ferrite.faces-Tuple{Ferrite.AbstractCell}"><code>faces</code></a> and <a href="../elements/#Ferrite.edges-Tuple{Ferrite.AbstractCell}"><code>edges</code></a>.</p><pre><code class="nohighlight hljs">Only required for nodal interpolations.

TODO: Separate nodal and non-nodal interpolations.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L290-L300">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.vertexdof_indices-Tuple{Interpolation}" href="#Ferrite.vertexdof_indices-Tuple{Interpolation}"><code>Ferrite.vertexdof_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vertexdof_indices(ip::Interpolation)</code></pre><p>A tuple containing tuples of local dof indices for the respective vertex in local enumeration on a cell defined by <a href="../elements/#Ferrite.vertices-Tuple{Ferrite.AbstractCell}"><code>vertices(::Cell)</code></a>. The vertex enumeration must match the vertex enumeration of the corresponding geometrical cell.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The dofs appearing in the tuple must be continuous and increasing! The first dof must be the 1, as vertex dofs are enumerated first.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L303-L313">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.facedof_indices-Tuple{Interpolation}" href="#Ferrite.facedof_indices-Tuple{Interpolation}"><code>Ferrite.facedof_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">facedof_indices(ip::Interpolation)</code></pre><p>A tuple containing tuples of all local dof indices for the respective face in local enumeration on a cell defined by <a href="../elements/#Ferrite.faces-Tuple{Ferrite.AbstractCell}"><code>faces(::Cell)</code></a>. The face enumeration must match the face enumeration of the corresponding geometrical cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L369-L375">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.facedof_interior_indices-Tuple{Interpolation}" href="#Ferrite.facedof_interior_indices-Tuple{Interpolation}"><code>Ferrite.facedof_interior_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">facedof_interior_indices(ip::Interpolation)</code></pre><p>A tuple containing tuples of the local dof indices on the interior of the respective face in local enumeration on a cell defined by <a href="../elements/#Ferrite.faces-Tuple{Ferrite.AbstractCell}"><code>faces(::Cell)</code></a>. The face enumeration must match the face enumeration of the corresponding geometrical cell. Note that the vertex and edge dofs are included here.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The dofs appearing in the tuple must be continuous and increasing! The first dof must be the computed via &quot;last edge interior dof index + 1&quot;, if face dofs exist.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L388-L399">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.edgedof_indices-Tuple{Interpolation}" href="#Ferrite.edgedof_indices-Tuple{Interpolation}"><code>Ferrite.edgedof_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">edgedof_indices(ip::Interpolation)</code></pre><p>A tuple containing tuples of local dof indices for the respective edge in local enumeration on a cell defined by <a href="../elements/#Ferrite.edges-Tuple{Ferrite.AbstractCell}"><code>edges(::Cell)</code></a>. The edge enumeration must match the edge enumeration of the corresponding geometrical cell.</p><p>The dofs are guaranteed to be aligned with the local ordering of the entities on the oriented edge. Here the first entries are the vertex dofs, followed by the edge interior dofs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L330-L339">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.edgedof_interior_indices-Tuple{Interpolation}" href="#Ferrite.edgedof_interior_indices-Tuple{Interpolation}"><code>Ferrite.edgedof_interior_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">edgedof_interior_indices(ip::Interpolation)</code></pre><p>A tuple containing tuples of the local dof indices on the interior of the respective edge in local enumeration on a cell defined by <a href="../elements/#Ferrite.edges-Tuple{Ferrite.AbstractCell}"><code>edges(::Cell)</code></a>. The edge enumeration must match the edge enumeration of the corresponding geometrical cell. Note that the vertex dofs are included here.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The dofs appearing in the tuple must be continuous and increasing! The first dof must be computed via &quot;last vertex dof index + 1&quot;, if edge dofs exist.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L355-L366">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.volumedof_interior_indices-Tuple{Interpolation}" href="#Ferrite.volumedof_interior_indices-Tuple{Interpolation}"><code>Ferrite.volumedof_interior_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">volumedof_interior_indices(ip::Interpolation)</code></pre><p>Tuple containing the dof indices associated with the interior of a volume.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The dofs appearing in the tuple must be continuous and increasing, volumedofs are enumerated last.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L402-L410">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.getnbasefunctions-Tuple{Interpolation}" href="#Ferrite.getnbasefunctions-Tuple{Interpolation}"><code>Ferrite.getnbasefunctions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Ferrite.getnbasefunctions(ip::Interpolation)</code></pre><p>Return the number of base functions for the interpolation <code>ip</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L173-L177">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.adjust_dofs_during_distribution-Tuple{Interpolation}" href="#Ferrite.adjust_dofs_during_distribution-Tuple{Interpolation}"><code>Ferrite.adjust_dofs_during_distribution</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">adjust_dofs_during_distribution(::Interpolation)</code></pre><p>This function must return <code>true</code> if the dofs should be adjusted (i.e. permuted) during dof distribution. This is in contrast to i) adjusting the dofs during <a href="../../reference/fevalues/#Ferrite.reinit!"><code>reinit!</code></a> in the assembly loop, or ii) not adjusting at all (which is not needed for low order interpolations, generally).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L100-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.conformity" href="#Ferrite.conformity"><code>Ferrite.conformity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">conformity(ip::Interpolation)</code></pre><p>Return the conformity, i.e. <code>L2Conformity()</code>, <code>HdivConformity()</code>, <code>HcurlConformity()</code>, or <code>H1Conformity()</code>, for the interpolation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L73-L78">source</a></section></article><h3 id="For-special-interpolations"><a class="docs-heading-anchor" href="#For-special-interpolations">For special interpolations</a><a id="For-special-interpolations-1"></a><a class="docs-heading-anchor-permalink" href="#For-special-interpolations" title="Permalink"></a></h3><h4 id="Discontinuous-interpolations"><a class="docs-heading-anchor" href="#Discontinuous-interpolations">Discontinuous interpolations</a><a id="Discontinuous-interpolations-1"></a><a class="docs-heading-anchor-permalink" href="#Discontinuous-interpolations" title="Permalink"></a></h4><p>For discontinuous interpolations, implementing the following methods might be required to apply Dirichlet boundary conditions.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.dirichlet_vertexdof_indices-Tuple{Interpolation}" href="#Ferrite.dirichlet_vertexdof_indices-Tuple{Interpolation}"><code>Ferrite.dirichlet_vertexdof_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dirichlet_vertexdof_indices(ip::Interpolation)</code></pre><p>A tuple containing tuples of local dof indices for the respective vertex in local enumeration on a cell defined by <a href="../elements/#Ferrite.vertices-Tuple{Ferrite.AbstractCell}"><code>vertices(::Cell)</code></a>. The vertex enumeration must match the vertex enumeration of the corresponding geometrical cell. Used internally in <a href="../../reference/boundary_conditions/#Ferrite.ConstraintHandler"><code>ConstraintHandler</code></a> and defaults to <a href="#Ferrite.vertexdof_indices-Tuple{Interpolation}"><code>vertexdof_indices(ip::Interpolation)</code></a> for continuous interpolation.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The dofs appearing in the tuple must be continuous and increasing! The first dof must be the 1, as vertex dofs are enumerated first.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L316-L327">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.dirichlet_facedof_indices-Tuple{Interpolation}" href="#Ferrite.dirichlet_facedof_indices-Tuple{Interpolation}"><code>Ferrite.dirichlet_facedof_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dirichlet_facedof_indices(ip::Interpolation)</code></pre><p>A tuple containing tuples of all local dof indices for the respective face in local enumeration on a cell defined by <a href="../elements/#Ferrite.faces-Tuple{Ferrite.AbstractCell}"><code>faces(::Cell)</code></a>. The face enumeration must match the face enumeration of the corresponding geometrical cell. Used internally in <a href="../../reference/boundary_conditions/#Ferrite.ConstraintHandler"><code>ConstraintHandler</code></a> and defaults to <a href="#Ferrite.facedof_indices-Tuple{Interpolation}"><code>facedof_indices(ip::Interpolation)</code></a> for continuous interpolation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L378-L385">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.dirichlet_edgedof_indices-Tuple{Interpolation}" href="#Ferrite.dirichlet_edgedof_indices-Tuple{Interpolation}"><code>Ferrite.dirichlet_edgedof_indices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dirichlet_edgedof_indices(ip::Interpolation)</code></pre><p>A tuple containing tuples of local dof indices for the respective edge in local enumeration on a cell defined by <a href="../elements/#Ferrite.edges-Tuple{Ferrite.AbstractCell}"><code>edges(::Cell)</code></a>. The edge enumeration must match the edge enumeration of the corresponding geometrical cell. Used internally in <a href="../../reference/boundary_conditions/#Ferrite.ConstraintHandler"><code>ConstraintHandler</code></a> and defaults to <a href="#Ferrite.edgedof_indices-Tuple{Interpolation}"><code>edgedof_indices(ip::Interpolation)</code></a> for continuous interpolation.</p><p>The dofs are guaranteed to be aligned with the local ordering of the entities on the oriented edge. Here the first entries are the vertex dofs, followed by the edge interior dofs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L342-L352">source</a></section></article><h4 id="Non-identity-mapping"><a class="docs-heading-anchor" href="#Non-identity-mapping">Non-identity mapping</a><a id="Non-identity-mapping-1"></a><a class="docs-heading-anchor-permalink" href="#Non-identity-mapping" title="Permalink"></a></h4><p>For interpolations that have a non-identity mapping (see <a href="../../topics/FEValues/#mapping_theory">Mapping of finite elements</a>), the mapping type must be specified.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.mapping_type" href="#Ferrite.mapping_type"><code>Ferrite.mapping_type</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mapping_type(ip::Interpolation)</code></pre><p>Get the type of mapping from the reference cell to the real cell for an interpolation <code>ip</code>. Subtypes of <code>ScalarInterpolation</code> and <code>VectorizedInterpolation</code> return <code>IdentityMapping()</code>, but other non-scalar interpolations may request different mapping types.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L1788-L1795">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.get_direction" href="#Ferrite.get_direction"><code>Ferrite.get_direction</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_direction(interpolation::Interpolation, shape_nr::Int, cell::AbstractCell)</code></pre><p>Return the direction, <code>±1</code>, of the cell entity (e.g. facet or edge) associated with the <code>interpolation</code>&#39;s shape function nr. <code>shape_nr</code>. This is only required for interpolations with non-identity mappings, where the direction is required during the mapping of the shape values.</p><p><strong>TODO:</strong> Move the following description to <code>get_edge_direction</code> and <code>get_face_direction</code> following #1162</p><p>The direction of entities are defined as following the node numbers of the entity&#39;s vertices, <code>vnodes</code>. For an edge, <code>vnodes[2] &gt; vnodes[1]</code> implies positive direction.</p><p>For a face, we first find index, <code>i</code>, of the smallest value in <code>vnodes</code>. Considering circular indexing, then a positive face has <code>vnodes[i-1] &gt; vnodes[i+1]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L1801-L1816">source</a></section></article><h3 id="The-defaults-should-always-work"><a class="docs-heading-anchor" href="#The-defaults-should-always-work">The defaults should always work</a><a id="The-defaults-should-always-work-1"></a><a class="docs-heading-anchor-permalink" href="#The-defaults-should-always-work" title="Permalink"></a></h3><p>The following functions are defined such that they should work for any interpolations that defines the required functions specified above.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.getrefshape-Tuple{Interpolation}" href="#Ferrite.getrefshape-Tuple{Interpolation}"><code>Ferrite.getrefshape</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Ferrite.getrefshape(::Interpolation)::AbstractRefShape</code></pre><p>Return the reference element shape of the interpolation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L154-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.getorder-Tuple{Interpolation}" href="#Ferrite.getorder-Tuple{Interpolation}"><code>Ferrite.getorder</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Ferrite.getorder(::Interpolation)</code></pre><p>Return order of the interpolation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L161-L165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.reference_shape_gradient-Tuple{Interpolation, Vec, Int64}" href="#Ferrite.reference_shape_gradient-Tuple{Interpolation, Vec, Int64}"><code>Ferrite.reference_shape_gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reference_shape_gradient(ip::Interpolation, ξ::Vec, i::Int)</code></pre><p>Evaluate the gradient of the <code>i</code>th shape function of the interpolation <code>ip</code> in reference coordinate <code>ξ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L259-L264">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.reference_shape_gradient_and_value-Tuple{Interpolation, Vec, Int64}" href="#Ferrite.reference_shape_gradient_and_value-Tuple{Interpolation, Vec, Int64}"><code>Ferrite.reference_shape_gradient_and_value</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reference_shape_gradient_and_value(ip::Interpolation, ξ::Vec, i::Int)</code></pre><p>Optimized version combining the evaluation <a href="#Ferrite.reference_shape_value-Tuple{Interpolation, Vec, Int64}"><code>Ferrite.reference_shape_value(::Interpolation)</code></a> and <a href="#Ferrite.reference_shape_gradient-Tuple{Interpolation, Vec, Int64}"><code>Ferrite.reference_shape_gradient(::Interpolation)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L269-L274">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.reference_shape_hessian_gradient_and_value-Tuple{Interpolation, Vec, Int64}" href="#Ferrite.reference_shape_hessian_gradient_and_value-Tuple{Interpolation, Vec, Int64}"><code>Ferrite.reference_shape_hessian_gradient_and_value</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reference_shape_hessian_gradient_and_value(ip::Interpolation, ξ::Vec, i::Int)</code></pre><p>Optimized version combining the evaluation <a href="#Ferrite.reference_shape_value-Tuple{Interpolation, Vec, Int64}"><code>Ferrite.reference_shape_value(::Interpolation)</code></a>, <a href="#Ferrite.reference_shape_gradient-Tuple{Interpolation, Vec, Int64}"><code>Ferrite.reference_shape_gradient(::Interpolation)</code></a>, and the gradient of the latter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L279-L284">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.boundarydof_indices" href="#Ferrite.boundarydof_indices"><code>Ferrite.boundarydof_indices</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">boundarydof_indices(::Type{&lt;:BoundaryIndex})</code></pre><p>Helper function to generically dispatch on the correct dof sets of a boundary entity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L419-L423">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.dirichlet_boundarydof_indices" href="#Ferrite.dirichlet_boundarydof_indices"><code>Ferrite.dirichlet_boundarydof_indices</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dirichlet_boundarydof_indices(::Type{&lt;:BoundaryIndex})</code></pre><p>Helper function to generically dispatch on the correct dof sets of a boundary entity. Used internally in <a href="../../reference/boundary_conditions/#Ferrite.ConstraintHandler"><code>ConstraintHandler</code></a> and defaults to <a href="#Ferrite.boundarydof_indices"><code>boundarydof_indices(ip::Interpolation)</code></a> for continuous interpolation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L444-L449">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.reference_shape_values!" href="#Ferrite.reference_shape_values!"><code>Ferrite.reference_shape_values!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reference_shape_values!(values::AbstractArray{T}, ip::Interpolation, ξ::Vec)</code></pre><p>Evaluate all shape functions of <code>ip</code> at once at the reference point <code>ξ</code> and store them in <code>values</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L186-L191">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.reference_shape_gradients!" href="#Ferrite.reference_shape_gradients!"><code>Ferrite.reference_shape_gradients!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reference_shape_gradients!(gradients::AbstractArray, ip::Interpolation, ξ::Vec)</code></pre><p>Evaluate all shape function gradients of <code>ip</code> at once at the reference point <code>ξ</code> and store them in <code>gradients</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L200-L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.reference_shape_gradients_and_values!" href="#Ferrite.reference_shape_gradients_and_values!"><code>Ferrite.reference_shape_gradients_and_values!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reference_shape_gradients_and_values!(gradients::AbstractArray, values::AbstractArray, ip::Interpolation, ξ::Vec)</code></pre><p>Evaluate all shape function gradients and values of <code>ip</code> at once at the reference point <code>ξ</code> and store them in <code>values</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L214-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.reference_shape_hessians_gradients_and_values!" href="#Ferrite.reference_shape_hessians_gradients_and_values!"><code>Ferrite.reference_shape_hessians_gradients_and_values!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reference_shape_hessians_gradients_and_values!(hessians::AbstractVector, gradients::AbstractVector, values::AbstractVector, ip::Interpolation, ξ::Vec)</code></pre><p>Evaluate all shape function hessians, gradients and values of <code>ip</code> at once at the reference point <code>ξ</code> and store them in <code>hessians</code>, <code>gradients</code>, and <code>values</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L229-L234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.shape_value_type-Union{Tuple{T}, Tuple{Interpolation, Type{T}}} where T&lt;:Number" href="#Ferrite.shape_value_type-Union{Tuple{T}, Tuple{Interpolation, Type{T}}} where T&lt;:Number"><code>Ferrite.shape_value_type</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">shape_value_type(ip::Interpolation, ::Type{T}) where T&lt;:Number</code></pre><p>Return the type of <code>shape_value(ip::Interpolation, ξ::Vec, ib::Int)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/interpolations.jl#L87-L91">source</a></section></article><h2 id="devdocs-howto_new-interpolation"><a class="docs-heading-anchor" href="#devdocs-howto_new-interpolation">How to implement a new interpolation</a><a id="devdocs-howto_new-interpolation-1"></a><a class="docs-heading-anchor-permalink" href="#devdocs-howto_new-interpolation" title="Permalink"></a></h2><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>The API for implementing a new interpolation is not fully stable yet.</p></div></div><p>As an example, we will implement a <code>Q</code>uadratic <code>T</code>riangle <code>I</code>nterpolation (<code>QTI</code>), corresponding to <code>Lagrange{RefTriangle, 2}()</code>. Since this interpolation gives scalar-valued shape functions, it is a subtype of <code>ScalarInterpolation</code>,</p><pre><code class="language-julia hljs">struct QTI &lt;: ScalarInterpolation{RefTriangle, 2}
end</code></pre><p>Before we jump in and define the shape functions associated with this interpolation, we first need to consider the <code>RefTriangle</code> entities,</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.RefTriangle-devdocs-interpolations" href="#Ferrite.RefTriangle-devdocs-interpolations"><code>Ferrite.RefTriangle</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RefTriangle &lt;: AbstractRefShape{2}</code></pre><p>Reference triangle, reference dimension 2.</p><pre><code class="nohighlight hljs">----------------+--------------------
Vertex numbers: | Vertex coordinates:
    2           |
    | \         | v1: 𝛏 = (1.0, 0.0)
    |   \       | v2: 𝛏 = (0.0, 1.0)
ξ₂^ |     \     | v3: 𝛏 = (0.0, 0.0)
  | 3-------1   |
  +--&gt; ξ₁       |
----------------+--------------------
Edge numbers:   | Edge identifiers:
    +           |
    | \         | e1: (v1, v2)
    2   1       | e2: (v2, v3)
    |     \     | e3: (v3, v1)
    +---3---+   |
----------------+--------------------
Face numbers:   | Face identifiers:
    +           |
    | \         |
    |   \       | f1: (v1, v2, v3)
    |  1  \     |
    +-------+   |
----------------+--------------------</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/1e49095423149140073401e5f1bd511fb0ebea5a/src/docs.jl#L22-L51">source</a></section></article><p>For this particular interpolation, we have one degree of freedom associated with each vertex, and one degree of freedom associated with each edge. Following the <a href="../../topics/degrees_of_freedom/#Ordering-of-dofs">Ferrite numbering rules</a>, we start by enumerating the vertices first, followed by the edges. The numbering is based on the <code>RefTriangle</code> shown above, and the actual shape functions are taken from <a href="https://defelement.org/elements/examples/triangle-lagrange-equispaced-2.html">defelement.org</a>.</p><pre><code class="language-julia hljs">function Ferrite.reference_shape_value(ip::QTI, ξ::Vec{2}, shape_number::Int)
    ξ₁ = ξ[1]
    ξ₂ = ξ[2]
    γ = 1 - ξ₁ - ξ₂ # Helper
    shape_number == 1 &amp;&amp; return ξ₁ * (2ξ₁ - 1) # v1: 1 at ξ = (1, 0)
    shape_number == 2 &amp;&amp; return ξ₂ * (2ξ₂ - 1) # v2: 1 at ξ = (0, 1)
    shape_number == 3 &amp;&amp; return γ * (2γ - 1)   # v3: 1 at ξ = (0, 0)
    shape_number == 4 &amp;&amp; return 4ξ₁ * ξ₂ # e1: 1 at ξ = (½, ½)
    shape_number == 5 &amp;&amp; return 4ξ₂ * γ  # e2: 1 at ξ = (0, ½)
    shape_number == 6 &amp;&amp; return 4ξ₁ * γ  # e3: 1 at ξ = (½, 0)
    throw(ArgumentError(&quot;no shape function $shape_number for interpolation $ip&quot;))
end</code></pre><p>Having defined the actual interpolation function, we must now provide the information in comments above to Ferrite. We start by providing the reference coordinate for each shape number,</p><pre><code class="language-julia hljs">function Ferrite.reference_coordinates(::QTI)
    return [
        Vec{2, Float64}((1.0, 0.0)), # v1
        Vec{2, Float64}((0.0, 1.0)), # v2
        Vec{2, Float64}((0.0, 0.0)), # v3
        Vec{2, Float64}((0.5, 0.5)), # center of e1
        Vec{2, Float64}((0.0, 0.5)), # center of e2
        Vec{2, Float64}((0.5, 0.0)), # center of e3
    ]
end</code></pre><p>We move on to defining which dof indices belong to each vertex. As we have 3 vertices on the <code>RefTriangle</code>, this should be a tuple with length 3, and each element contains all dof indices for the particular vertex. In this case, we only have a single dof per vertex,</p><pre><code class="language-julia hljs">Ferrite.vertexdof_indices(::QTI) = ((1,), (2,), (3,))</code></pre><p>Note that the dof index numbering must be in order, first all in the first vertex, then all in the next vertex, and so on. (If we had two indices per vertex, we would have <code>((1,2), (3,4), (5,6))</code>). Next, we number the edge dofs, following the same convention, matching how we defined it above,</p><pre><code class="language-julia hljs">Ferrite.edgedof_interior_indices(::QTI) = ((4,), (5,), (6,))
Ferrite.edgedof_indices(::QTI) = ((1, 2, 4,), (2, 3, 5,), (3, 1, 6,))</code></pre><p>But here we need two functions, one for the <code>interior</code> indices (those that have not yet been included in lower-dimensional entities (vertices in this case)), and one for all indices for dofs that belong to the edge.</p><p>For the triangle, we only have a single face. However, all the dofs that belong to the face, also belongs to either the vertices or edges, hence we have no &quot;interior&quot; face dofs. So we get,</p><pre><code class="language-julia hljs">Ferrite.facedof_interior_indices(::QTI) = ((),)
Ferrite.facedof_indices(::QTI) = ((1, 2, 3, 4, 5, 6),)</code></pre><p>Finally, since this is a 2d element, we have no <code>volumedofs</code>, and thus</p><pre><code class="language-julia hljs">Ferrite.volumedof_interior_indices(::QTI) = ()</code></pre><p>It is necessary to tell Ferrite the total number of base functions, e.g.,</p><pre><code class="language-julia hljs">Ferrite.getnbasefunctions(::QTI) = 6</code></pre><p>For distributing the degrees of freedom, higher order interpolations require that we account for the ordering on their entity. For example, if we have two interior dofs associated with an edge, we must match them the edges of the for the cells that share the edge, to make sure we consider the same ordering. Since we only have a single interior dof per edge, we don&#39;t need to adjust these, hence,</p><pre><code class="language-julia hljs">Ferrite.adjust_dofs_during_distribution(::QTI) = false</code></pre><p>Finally, our interpolation results in continuous function values across cell borders, but the derivatives are discontinous. Hence, it describes a <span>$H_1$</span> conformity,</p><pre><code class="language-julia hljs">Ferrite.conformity(::QTI) = Ferrite.H1Conformity()</code></pre><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>The function <code>test_interpolation_properties</code> in <code>test/test_interpolations.jl</code> can be used when implementation to check that some basic properties are fulfilled.</p></div></div></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Sunday 6 July 2025 19:44">Sunday 6 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
