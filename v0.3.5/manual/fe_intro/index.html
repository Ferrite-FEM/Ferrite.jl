<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction to FEM · Ferrite.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Ferrite.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li class="is-active"><a class="tocitem" href>Introduction to FEM</a><ul class="internal"><li><a class="tocitem" href="#Strong-form"><span>Strong form</span></a></li><li><a class="tocitem" href="#Weak-form"><span>Weak form</span></a></li><li><a class="tocitem" href="#Finite-Element-approximation"><span>Finite Element approximation</span></a></li><li><a class="tocitem" href="#Notes-on-the-implementation"><span>Notes on the implementation</span></a></li><li><a class="tocitem" href="#More-Details"><span>More Details</span></a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../degrees_of_freedom/">Degrees of Freedom</a></li><li><a class="tocitem" href="../assembly/">Assembly</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary Conditions</a></li><li><a class="tocitem" href="../constraints/">Constraints</a></li><li><a class="tocitem" href="../grid/">Grid</a></li><li><a class="tocitem" href="../export/">Export</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/heat_equation/">Heat Equation</a></li><li><a class="tocitem" href="../../examples/postprocessing/">Postprocessing</a></li><li><a class="tocitem" href="../../examples/helmholtz/">Helmholtz equation</a></li><li><a class="tocitem" href="../../examples/incompressible_elasticity/">Incompressible Elasticity</a></li><li><a class="tocitem" href="../../examples/hyperelasticity/">Hyperelasticity</a></li><li><a class="tocitem" href="../../examples/threaded_assembly/">Threaded Assembly</a></li><li><a class="tocitem" href="../../examples/plasticity/">von Mises plasticity</a></li><li><a class="tocitem" href="../../examples/transient_heat_equation/">Time Dependent Problems</a></li><li><a class="tocitem" href="../../examples/landau/">Ginzburg-Landau model energy minimization</a></li><li><a class="tocitem" href="../../examples/linear_shell/">Linear shell</a></li><li><a class="tocitem" href="../../examples/quasi_incompressible_hyperelasticity/">Nearly Incompressible Hyperelasticity</a></li><li><a class="tocitem" href="../../examples/ns_vs_diffeq/">Incompressible Navier-Stokes Equations via DifferentialEquations.jl</a></li><li><a class="tocitem" href="../../examples/computational_homogenization/">Computational homogenization</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../reference/quadrature/">Quadrature</a></li><li><a class="tocitem" href="../../reference/interpolations/">Interpolation</a></li><li><a class="tocitem" href="../../reference/fevalues/">FEValues</a></li><li><a class="tocitem" href="../../reference/dofhandler/">Degrees of Freedom</a></li><li><a class="tocitem" href="../../reference/assembly/">Assembly</a></li><li><a class="tocitem" href="../../reference/boundary_conditions/">Boundary Conditions</a></li><li><a class="tocitem" href="../../reference/grid/">Grid &amp; AbstractGrid</a></li><li><a class="tocitem" href="../../reference/export/">Postprocessing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Introduction to FEM</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction to FEM</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/master/docs/src/manual/fe_intro.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Introduction-to-FEM"><a class="docs-heading-anchor" href="#Introduction-to-FEM">Introduction to FEM</a><a id="Introduction-to-FEM-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction-to-FEM" title="Permalink"></a></h1><p>Here we will present a very brief introduction to partial differential equations (PDEs) and to the finite element method (FEM). Perhaps the simplest PDE of all is the (steady-state, linear) heat equation, also known as the Poisson equation. We will use this equation as a demonstrative example of the method, and demonstrate how we go from the strong form of the equation, to the weak form, and then finally to the discrete FE problem.</p><h2 id="Strong-form"><a class="docs-heading-anchor" href="#Strong-form">Strong form</a><a id="Strong-form-1"></a><a class="docs-heading-anchor-permalink" href="#Strong-form" title="Permalink"></a></h2><p>The strong form of the heat equation may be written as:</p><p class="math-container">\[- \nabla \cdot \mathbf{q}(u) = f \quad \forall \, \mathbf{x} \in \Omega,\]</p><p>where <span>$u$</span> is the unknown temperature field, <span>$\mathbf{q}$</span> is the heat flux, <span>$f$</span> is an internal heat source, and <span>$\Omega$</span> is the domain on which the equation is defined. To complete the problem we need to specify what happens at the domain boundary <span>$\Gamma$</span>. This set of specifications is called <em>boundary conditions</em>. There are different types of boundary conditions, where the most common ones are Dirichlet – which means that the solution <span>$u$</span> is known at some part of the boundary, and Neumann – which means that the gradient of the solution, <span>$\nabla u$</span> is known. Formally we write for our example</p><p class="math-container">\[u = u^\mathrm{p} \quad \forall \, \mathbf{x} \in \Gamma_\mathrm{D},\\
\mathbf{q} \cdot \mathbf{n} = q^\mathrm{p} \quad \forall \, \mathbf{x} \in \Gamma_\mathrm{N},\]</p><p>i.e. the temperature is prescribed to a known function <span>$u^\mathrm{p}$</span> at the Dirichlet part of the boundary, <span>$\Gamma_\mathrm{D}$</span>, and the heat flux is prescribed to <span>$q^\mathrm{p}$</span> at the Neumann part of the boundary, <span>$\Gamma_\mathrm{N}$</span>, where <span>$\mathbf{n}$</span> describes the outward pointing normal vector at the boundary.</p><p>We also need a constitutive equation which links the temperature field, <span>$u$</span>, to the heat flux, <span>$\mathbf{q}$</span>. The simplest case is to use Fourier&#39;s law</p><p class="math-container">\[\mathbf{q}(u) = -k \nabla u\]</p><p>where <span>$k$</span> is the conductivity of the material. For simplicity we will consider only constant conductivity <span>$k$</span>.</p><h2 id="Weak-form"><a class="docs-heading-anchor" href="#Weak-form">Weak form</a><a id="Weak-form-1"></a><a class="docs-heading-anchor-permalink" href="#Weak-form" title="Permalink"></a></h2><p>The solution to the equation above is usually calculated from the corresponding weak form. By multiplying the equation with an arbitrary <em>test function</em> <span>$\delta u$</span>, integrating over the domain and using partial integration we obtain the <em>weak form</em>. Now our problem can be stated as:</p><p>Find <span>$u \in \mathbb{U}$</span> s.t.</p><p class="math-container">\[\int_\Omega \nabla \delta u \cdot (k \nabla u) \, \mathrm{d}\Omega =
\int_{\Gamma_\mathrm{N}} \delta u \, q^\mathrm{p} \, \mathrm{d}\Gamma +
\int_\Omega \delta u \, b \, \mathrm{d}\Omega \quad \forall \, \delta u \in \mathbb{T}\]</p><p>where <span>$\mathbb{U}, \mathbb{T}$</span> are suitable function spaces with sufficiently regular functions. Under very general assumptions it can be shown that the solution to the weak form is identical to the solution to the strong form.</p><h2 id="Finite-Element-approximation"><a class="docs-heading-anchor" href="#Finite-Element-approximation">Finite Element approximation</a><a id="Finite-Element-approximation-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-Element-approximation" title="Permalink"></a></h2><p>Using the finite element method to solve partial differential equations is usually preceded with the construction of a discretization of the domain <span>$\Omega$</span> into a finite set of <em>elements</em> or <em>cells</em>. We call this geometric discretization <em>grid</em> (or <em>mesh</em>) and denote it with <span>$\Omega_h$</span>. In this example the corners of the triangles are called <em>nodes</em>.</p><p>Next we introduce the finite element approximation <span>$u_\mathrm{h} \approx u$</span> as a sum of N nodal <em>shape functions</em>, where we denote each of these function by <span>$\phi_i$</span> and the corresponding <em>nodal values</em> <span>$\hat{u}_i$</span>. Note that <em>shape functions</em> are sometimes referred to as <em>base functions</em> or <em>trial functions</em>, and instead of <span>$\phi_i$</span> they are sometimes denoted <span>$N_i$</span>. In this example we choose to approximate the test function in the same way. This approach is known as the <em>Galerkin finite element method</em>. Formally we write the evaluation of our approximations at a specific point <span>$\mathbf{x}$</span> in our domain <span>$\Omega$</span> as:</p><p class="math-container">\[u_\mathrm{h}(\mathbf{x}) = \sum_{i=1}^{\mathrm{N}} \phi_i(\mathbf{x}) \, \hat{u}_i,\qquad
\delta u_\mathrm{h}(\mathbf{x}) = \sum_{i=1}^{\mathrm{N}} \phi_i(\mathbf{x}) \, \delta \hat{u}_i \, .\]</p><p>Since test and trial functions are usually chosen in such a way, that they build the basis of some function space (basis as in basis of a vector space), sometimes are they are also called <em>basis functions</em>. In the following the argument <span>$\mathbf{x}$</span> is dropped to keep the notation compact. We may now insert these approximations in the weak form, which results in</p><p class="math-container">\[\sum_i^N \left(\sum_j^N \delta \hat{u}_i \int_{\Omega_\mathrm{h}} \nabla \phi_i \cdot (k \nabla \phi_j) \, \mathrm{d}\Omega \right) \hat{u}_j =
\sum_i^N \delta \hat{u}_i \int_{\Gamma_\mathrm{N}} \phi_i \, q^\mathrm{p} \, \mathrm{d}\Gamma +
\sum_i^N \delta \hat{u}_i \int_{\Omega_\mathrm{h}} \phi_i \, f \, \mathrm{d}\Omega \, .\]</p><p>Since this equation must hold for arbitrary <span>$\delta u_\mathrm{h}$</span>, the equation must especially hold for the specific choice that only one of the nodal values <span>$\delta \hat{u}_i$</span> is fixed to 1 while an all other coefficients are fixed to 0. Repeating this argument for all <span>$i$</span> from 1 to N we obtain N linear equations. This way the discrete problem can be written as a system of linear equations</p><p class="math-container">\[\underline{\underline{K}}\ \underline{\hat{u}} = \underline{\hat{f}} \, ,\]</p><p>where we call <span>$\underline{\underline{K}}$</span> the (tangent) <em>stiffness matrix</em>, <span>$\underline{\hat{u}}$</span> the <em>solution vector</em> with the nodal values and <span>$\underline{\hat{f}}$</span> the <em>force vector</em>. The specific naming is for historical reasons, because the finite element method has its origins in mechanics. The elements of <span>$\underline{\underline{K}}$</span> and <span>$\underline{\hat{f}}$</span> are given by</p><p class="math-container">\[(\underline{\underline{K}})_{ij} =
    \int_{\Omega_\mathrm{h}} \nabla \phi_i \cdot (k \nabla \phi_j) \mathrm{d}\Omega \, , \\

(\underline{\hat{f}})_{i} =
    \int_{\Gamma_\mathrm{N}} \phi_i \, q^\mathrm{p} \, \mathrm{d}\Gamma + \int_{\Omega_\mathrm{h}} \phi_i \, f \, \mathrm{d}\Omega \, .\]</p><p>Finally we also need to take care of the Dirichlet boundary conditions. These are enforced by setting the corresponding <span>$\hat{u}_i$</span> to the prescribed values and eliminating the associated equations from the system. Now, solving this equation system yields the nodal values and thus an approximation to the true solution.</p><h2 id="Notes-on-the-implementation"><a class="docs-heading-anchor" href="#Notes-on-the-implementation">Notes on the implementation</a><a id="Notes-on-the-implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Notes-on-the-implementation" title="Permalink"></a></h2><p>In practice, the shape functions <span>$\phi_i$</span> are only non-zero on parts of the domain <span>$\Omega_\mathrm{h}$</span>. Thus, the integrals are evaluated on sub-domains, called <em>elements</em> or <em>cells</em>.</p><p>Each cell gives a contribution to the global stiffness matrix and force vector. The process of constructing the system of equations is also called <em>assembly</em>. For clarification, let us rewrite the formula for the stiffness matrix entries as follows:</p><p class="math-container">\[(\underline{\underline{K}})_{ij}
    = \int_{\Omega_\mathrm{h}} \nabla \phi_i \cdot (k \nabla \phi_j) \mathrm{d}\Omega
    = \sum_{E \in \Omega_\mathrm{h}} \int_E \nabla \phi_i \cdot (k \nabla \phi_j) \mathrm{d}\Omega \, .\]</p><p>This formulation underlines the element-centric perspective of finite element methods and reflects how it is usually implemented in software.</p><p>Computing the element integrals by hand can become a tedious task. To avoid this issue we approximate the element integrals with a technique called <em>numerical integration</em>. Skipping any of the mathematical details, the basic idea is to evaluate the function under the integral at specific points and weighting the evaluations accordingly, such that their sum approximates the volume properly. A very nice feature of these techniques is, that under quite general circumstances the formula is not just an approximation, but the exact evaluation of the integral. To avoid the recomputation of the just mentioned evaluation positions of the integral for each individual element, we perform a coordinate transformation onto a so-called <em>reference element</em>. Formally we write</p><p class="math-container">\[    \int_E \nabla \phi_i \cdot (k \nabla \phi_j) \mathrm{d}\Omega
    \approx \sum_q \nabla \phi_i(\textbf{x}_q) \cdot (k(\textbf{x}_q) \nabla \phi_j(\textbf{x}_q)) \, w_q \, \textrm{det}(J(\textbf{x}_q)) \, ,\]</p><p>where <span>$J$</span> is the Jacobian of the coordinate transformation function. The computation of the transformation, weights, positions and of the Jacobi determinant is handled by Ferrite. On an intuitive level, and to explain the notation used in the implementation, we think of</p><p class="math-container">\[    \mathrm{d}\Omega \approx \, w \, \textrm{det}(J)\]</p><p>being the chosen approximation when changing from the integral to the finite summation.</p><p>For an example of the implementation to solve a heat problem with <code>Ferrite</code> check out <a href="../../examples/heat_equation/#Heat-Equation">this thoroughly commented example</a>.</p><h2 id="More-Details"><a class="docs-heading-anchor" href="#More-Details">More Details</a><a id="More-Details-1"></a><a class="docs-heading-anchor-permalink" href="#More-Details" title="Permalink"></a></h2><p>We finally want to note that this quick introduction barely scratches the surface of the finite element method. Also, we presented some things in a simplified way for the sake of keeping this article short and concise. There is a large corpus of literature and online tutorials containing more details about the finite element method. To give a few recommendations there is:</p><ul><li><a href="http://hplgit.github.io/INF5620/doc/pub/sphinx-fem/index.html">Hans Petter Langtangen&#39;s Script</a></li><li><a href="https://www.math.colostate.edu/~bangerth/videos.html">Wolfgang Bangerth&#39;s Lecture Series</a></li><li><em>Introduction to the Finite Element Method</em> by Niels Ottosen and Hans Petersson</li><li><em>The Finite Element Method for Elliptic Problems</em> by Philippe Ciarlet</li><li><em>Finite Elements: Theory, Fast Solvers, and Applications in Elasticity Theory</em> by Dietrich Braess</li><li><em>An Analysis of the Finite Element Method</em> by Gilbert Strang and George Fix</li><li><em>Finite Element Procedures</em> by Klaus-Jürgen Bathe</li><li><em>The Finite Element Method: Its Basis and Fundamentals</em> by Olgierd Cecil Zienkiewicz, Robert Taylor and J.Z. Zhu</li><li><em>Higher-Order Finite Element Methods</em> by Pavel Šolín, Karel Segeth and Ivo Doležel</li></ul><p>This list is neither meant to be exhaustive, nor does the absence of a work mean that it is in any way bad or not recommendable. The ordering of the articles also has no particular meaning.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../degrees_of_freedom/">Degrees of Freedom »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Monday 30 May 2022 18:19">Monday 30 May 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
