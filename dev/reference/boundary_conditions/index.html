<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Boundary conditions · Ferrite.jl</title><meta name="title" content="Boundary conditions · Ferrite.jl"/><meta property="og:title" content="Boundary conditions · Ferrite.jl"/><meta property="twitter:title" content="Boundary conditions · Ferrite.jl"/><meta name="description" content="Documentation for Ferrite.jl."/><meta property="og:description" content="Documentation for Ferrite.jl."/><meta property="twitter:description" content="Documentation for Ferrite.jl."/><meta property="og:url" content="https://ferrite-fem.github.io/Ferrite.jl/stable/reference/boundary_conditions/"/><meta property="twitter:url" content="https://ferrite-fem.github.io/Ferrite.jl/stable/reference/boundary_conditions/"/><link rel="canonical" href="https://ferrite-fem.github.io/Ferrite.jl/stable/reference/boundary_conditions/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Ferrite.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Ferrite.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/">Tutorials overview</a></li><li><a class="tocitem" href="../../tutorials/heat_equation/">Heat equation</a></li><li><a class="tocitem" href="../../tutorials/linear_elasticity/">Linear elasticity</a></li><li><a class="tocitem" href="../../tutorials/incompressible_elasticity/">Incompressible elasticity</a></li><li><a class="tocitem" href="../../tutorials/hyperelasticity/">Hyperelasticity</a></li><li><a class="tocitem" href="../../tutorials/plasticity/">Von Mises plasticity</a></li><li><a class="tocitem" href="../../tutorials/transient_heat_equation/">Transient heat equation</a></li><li><a class="tocitem" href="../../tutorials/computational_homogenization/">Computational homogenization</a></li><li><a class="tocitem" href="../../tutorials/stokes-flow/">Stokes flow</a></li><li><a class="tocitem" href="../../tutorials/porous_media/">Porous media</a></li><li><a class="tocitem" href="../../tutorials/ns_vs_diffeq/">Incompressible Navier-Stokes equations via DifferentialEquations.jl</a></li><li><a class="tocitem" href="../../tutorials/reactive_surface/">Reactive surface</a></li><li><a class="tocitem" href="../../tutorials/linear_shell/">Linear shell</a></li><li><a class="tocitem" href="../../tutorials/dg_heat_equation/">Discontinuous Galerkin heat equation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Topic guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../topics/">Topic guide overview</a></li><li><a class="tocitem" href="../../topics/fe_intro/">Introduction to FEM</a></li><li><a class="tocitem" href="../../topics/reference_shapes/">Reference shapes</a></li><li><a class="tocitem" href="../../topics/FEValues/">FEValues</a></li><li><a class="tocitem" href="../../topics/degrees_of_freedom/">Degrees of Freedom</a></li><li><a class="tocitem" href="../../topics/sparse_matrix/">Sparsity pattern and sparse matrices</a></li><li><a class="tocitem" href="../../topics/assembly/">Assembly</a></li><li><a class="tocitem" href="../../topics/boundary_conditions/">Boundary and initial conditions</a></li><li><a class="tocitem" href="../../topics/constraints/">Affine constraints</a></li><li><a class="tocitem" href="../../topics/grid/">Grid</a></li><li><a class="tocitem" href="../../topics/export/">Export</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">API reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Reference overview</a></li><li><a class="tocitem" href="../quadrature/">Quadrature</a></li><li><a class="tocitem" href="../interpolations/">Interpolation</a></li><li><a class="tocitem" href="../fevalues/">FEValues</a></li><li><a class="tocitem" href="../dofhandler/">Degrees of Freedom</a></li><li><a class="tocitem" href="../sparsity_pattern/">Sparsity pattern and sparse matrices</a></li><li><a class="tocitem" href="../assembly/">Assembly</a></li><li class="is-active"><a class="tocitem" href>Boundary conditions</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Initial-conditions"><span>Initial conditions</span></a></li></ul></li><li><a class="tocitem" href="../grid/">Grid &amp; AbstractGrid</a></li><li><a class="tocitem" href="../export/">Postprocessing</a></li><li><a class="tocitem" href="../utils/">Development utility functions</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">How-to guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../howto/">How-to guide overview</a></li><li><a class="tocitem" href="../../howto/postprocessing/">Post processing and visualization</a></li><li><a class="tocitem" href="../../howto/threaded_assembly/">Multi-threaded assembly</a></li></ul></li><br><li><a class="tocitem" href="../../gallery/">Code gallery</a></li><li><a class="tocitem" href="../../devdocs/">Developer documentation</a></li><li><a class="tocitem" href="../../cited-literature/">Cited literature</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API reference</a></li><li class="is-active"><a href>Boundary conditions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Boundary conditions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Ferrite-FEM/Ferrite.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/master/docs/src/reference/boundary_conditions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Boundary-conditions"><a class="docs-heading-anchor" href="#Boundary-conditions">Boundary conditions</a><a id="Boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-conditions" title="Permalink"></a></h1><ul><li><a href="#Ferrite.ConstraintHandler"><code>Ferrite.ConstraintHandler</code></a></li><li><a href="#Ferrite.Dirichlet"><code>Ferrite.Dirichlet</code></a></li><li><a href="#Ferrite.PeriodicDirichlet"><code>Ferrite.PeriodicDirichlet</code></a></li><li><a href="#Ferrite.RHSData"><code>Ferrite.RHSData</code></a></li><li><a href="#Ferrite.add!"><code>Ferrite.add!</code></a></li><li><a href="#Ferrite.apply!"><code>Ferrite.apply!</code></a></li><li><a href="#Ferrite.apply_analytical!"><code>Ferrite.apply_analytical!</code></a></li><li><a href="#Ferrite.apply_assemble!"><code>Ferrite.apply_assemble!</code></a></li><li><a href="#Ferrite.apply_local!"><code>Ferrite.apply_local!</code></a></li><li><a href="#Ferrite.apply_rhs!"><code>Ferrite.apply_rhs!</code></a></li><li><a href="#Ferrite.apply_zero!"><code>Ferrite.apply_zero!</code></a></li><li><a href="#Ferrite.close!"><code>Ferrite.close!</code></a></li><li><a href="#Ferrite.collect_periodic_facets"><code>Ferrite.collect_periodic_facets</code></a></li><li><a href="#Ferrite.collect_periodic_facets!"><code>Ferrite.collect_periodic_facets!</code></a></li><li><a href="#Ferrite.get_rhs_data"><code>Ferrite.get_rhs_data</code></a></li><li><a href="#Ferrite.update!"><code>Ferrite.update!</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.ConstraintHandler" href="#Ferrite.ConstraintHandler"><code>Ferrite.ConstraintHandler</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ConstraintHandler([T=Float64], dh::AbstractDofHandler)</code></pre><p>A collection of constraints associated with the dof handler <code>dh</code>. <code>T</code> is the numeric type for stored values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L78-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.Dirichlet" href="#Ferrite.Dirichlet"><code>Ferrite.Dirichlet</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Dirichlet(u::Symbol, ∂Ω::AbstractVecOrSet, f::Function, components=nothing)</code></pre><p>Create a Dirichlet boundary condition on <code>u</code> on the <code>∂Ω</code> part of the boundary. <code>f</code> is a function of the form <code>f(x)</code> or <code>f(x, t)</code> where <code>x</code> is the spatial coordinate and <code>t</code> is the current time, and returns the prescribed value. <code>components</code> specify the components of <code>u</code> that are prescribed by this condition. By default all components of <code>u</code> are prescribed.</p><p>The set, <code>∂Ω</code>, can be an <code>AbstractSet</code> or <code>AbstractVector</code> with elements of type <a href="../grid/#Ferrite.FacetIndex"><code>FacetIndex</code></a>, <a href="../grid/#Ferrite.FaceIndex"><code>FaceIndex</code></a>, <a href="../grid/#Ferrite.EdgeIndex"><code>EdgeIndex</code></a>, <a href="../grid/#Ferrite.VertexIndex"><code>VertexIndex</code></a>, or <code>Int</code>. For most cases, the element type is <code>FacetIndex</code>, as shown below. To constrain a single point, using <code>VertexIndex</code> is recommended, but it is also possible to constrain a specific nodes by giving the node numbers via <code>Int</code> elements. To constrain e.g. an edge in 3d <code>EdgeIndex</code> elements can be given.</p><p>For example, here we create a Dirichlet condition for the <code>:u</code> field, on the facetset called <code>∂Ω</code> and the value given by the <code>sin</code> function:</p><p><em>Examples</em></p><pre><code class="language-julia hljs"># Obtain the facetset from the grid
∂Ω = getfacetset(grid, &quot;boundary-1&quot;)

# Prescribe scalar field :s on ∂Ω to sin(t)
dbc = Dirichlet(:s, ∂Ω, (x, t) -&gt; sin(t))

# Prescribe all components of vector field :v on ∂Ω to 0
dbc = Dirichlet(:v, ∂Ω, x -&gt; 0 * x)

# Prescribe component 2 and 3 of vector field :v on ∂Ω to [sin(t), cos(t)]
dbc = Dirichlet(:v, ∂Ω, (x, t) -&gt; [sin(t), cos(t)], [2, 3])</code></pre><p><code>Dirichlet</code> boundary conditions are added to a <a href="#Ferrite.ConstraintHandler"><code>ConstraintHandler</code></a> which applies the condition via <a href="#Ferrite.apply!"><code>apply!</code></a> and/or <a href="#Ferrite.apply_zero!"><code>apply_zero!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L2-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.PeriodicDirichlet" href="#Ferrite.PeriodicDirichlet"><code>Ferrite.PeriodicDirichlet</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PeriodicDirichlet(u::Symbol, facet_mapping, components=nothing)
PeriodicDirichlet(u::Symbol, facet_mapping, R::AbstractMatrix, components=nothing)
PeriodicDirichlet(u::Symbol, facet_mapping, f::Function, components=nothing)</code></pre><p>Create a periodic Dirichlet boundary condition for the field <code>u</code> on the facet-pairs given in <code>facet_mapping</code>. The mapping can be computed with <a href="#Ferrite.collect_periodic_facets"><code>collect_periodic_facets</code></a>. The constraint ensures that degrees-of-freedom on the mirror facet are constrained to the corresponding degrees-of-freedom on the image facet. <code>components</code> specify the components of <code>u</code> that are prescribed by this condition. By default all components of <code>u</code> are prescribed.</p><p>If the mapping is not aligned with the coordinate axis (e.g. rotated) a rotation matrix <code>R</code> should be passed to the constructor. This matrix rotates dofs on the mirror facet to the image facet. Note that this is only applicable for vector-valued problems.</p><p>To construct an inhomogeneous periodic constraint it is possible to pass a function <code>f</code>. Note that this is currently only supported when the periodicity is aligned with the coordinate axes.</p><p>See the manual section on <a href="../../topics/boundary_conditions/#Periodic-boundary-conditions">Periodic boundary conditions</a> for more information.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L896-L916">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.collect_periodic_facets" href="#Ferrite.collect_periodic_facets"><code>Ferrite.collect_periodic_facets</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">collect_periodic_facets(grid::Grid, mset, iset, transform::Union{Function,Nothing}=nothing; tol=1e-12)</code></pre><p>Match all mirror facets in <code>mset</code> with a corresponding image facet in <code>iset</code>. Return a dictionary which maps each mirror facet to a image facet. The result can then be passed to <a href="#Ferrite.PeriodicDirichlet"><code>PeriodicDirichlet</code></a>.</p><p><code>mset</code> and <code>iset</code> can be given as a <code>String</code> (an existing facet set in the grid) or as a <code>AbstractSet{FacetIndex}</code> directly.</p><p>By default this function looks for a matching facet in the directions of the coordinate system. For other types of periodicities the <code>transform</code> function can be used. The <code>transform</code> function is applied on the coordinates of the image facet, and is expected to transform the coordinates to the matching locations in the mirror set.</p><p>The keyword <code>tol</code> specifies the tolerance (i.e. distance and deviation in facet-normals) between a image-facet and mirror-facet, for them to be considered matched.</p><p>See also: <a href="#Ferrite.collect_periodic_facets!"><code>collect_periodic_facets!</code></a>, <a href="#Ferrite.PeriodicDirichlet"><code>PeriodicDirichlet</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L1258-L1277">source</a></section><section><div><pre><code class="language-julia hljs">collect_periodic_facets(grid::Grid, all_facets::Union{AbstractSet{FacetIndex},String,Nothing}=nothing; tol=1e-12)</code></pre><p>Split all facets in <code>all_facets</code> into image and mirror sets. For each matching pair, the facet located further along the vector <code>(1, 1, 1)</code> becomes the image facet.</p><p>If no set is given, all facets on the outer boundary of the grid (i.e. all facets that do not have a neighbor) is used.</p><p>See also: <a href="#Ferrite.collect_periodic_facets!"><code>collect_periodic_facets!</code></a>, <a href="#Ferrite.PeriodicDirichlet"><code>PeriodicDirichlet</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L1282-L1292">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.collect_periodic_facets!" href="#Ferrite.collect_periodic_facets!"><code>Ferrite.collect_periodic_facets!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">collect_periodic_facets!(facet_map::Vector{PeriodicFacetPair}, grid::Grid, mset, iset, transform::Union{Function,Nothing}; tol=1e-12)</code></pre><p>Same as <a href="#Ferrite.collect_periodic_facets"><code>collect_periodic_facets</code></a> but adds all matches to the existing <code>facet_map</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L1298-L1302">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.add!" href="#Ferrite.add!"><code>Ferrite.add!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add!(sdh::SubDofHandler, name::Symbol, ip::Interpolation)</code></pre><p>Add a field called <code>name</code> approximated by <code>ip</code> to the SubDofHandler <code>sdh</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/DofHandler.jl#L263-L267">source</a></section><section><div><pre><code class="language-julia hljs">add!(dh::DofHandler, name::Symbol, ip::Interpolation)</code></pre><p>Add a field called <code>name</code> approximated by <code>ip</code> to the DofHandler <code>dh</code>.</p><p>The field is added to all cells of the underlying grid, use <a href="../dofhandler/#Ferrite.SubDofHandler"><code>SubDofHandler</code></a>s if the grid contains multiple cell types, or to add the field to subset of all the cells.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/DofHandler.jl#L302-L310">source</a></section><section><div><pre><code class="language-julia hljs">add!(ch::ConstraintHandler, ac::AffineConstraint)</code></pre><p>Add the <code>AffineConstraint</code> to the <code>ConstraintHandler</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L265-L269">source</a></section><section><div><pre><code class="language-julia hljs">add!(ch::ConstraintHandler, dbc::Dirichlet)</code></pre><p>Add a <code>Dirichlet</code> boundary condition to the <code>ConstraintHandler</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L818-L822">source</a></section><section><div><pre><code class="language-julia hljs">add!(proj::L2Projector, set::AbstractVecOrSet{Int}, ip::Interpolation;
    qr_rhs, [qr_lhs])</code></pre><p>Add an interpolation <code>ip</code> on the cells in <code>set</code> to the <code>L2Projector</code> <code>proj</code>.</p><ul><li><code>qr_rhs</code> sets the quadrature rule used to later integrate the right-hand-side of the projection equation, when calling <a href="../export/#Ferrite.project"><code>project</code></a>. It should match the quadrature points used when creating the quadrature-point variables to project.</li><li>The <em>optional</em> <code>qr_lhs</code> sets the quadrature rule used to integrate the left-hand-side of the projection equation, and defaults to a quadrature rule that integrates the mass-matrix exactly for the given interpolation <code>ip</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/L2_projection.jl#L94-L106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.close!" href="#Ferrite.close!"><code>Ferrite.close!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">close!(dh::AbstractDofHandler)</code></pre><p>Closes <code>dh</code> and creates degrees of freedom for each cell.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/DofHandler.jl#L332-L336">source</a></section><section><div><pre><code class="language-julia hljs">close!(ch::ConstraintHandler)</code></pre><p>Close and finalize the <code>ConstraintHandler</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L206-L210">source</a></section><section><div><pre><code class="language-julia hljs">close!(proj::L2Projector)</code></pre><p>Close <code>proj</code> which assembles and calculates the left-hand-side of the projection equation, before doing a Cholesky factorization of the mass-matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/L2_projection.jl#L126-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.update!" href="#Ferrite.update!"><code>Ferrite.update!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update!(ch::ConstraintHandler, time::Real=0.0)</code></pre><p>Update time-dependent inhomogeneities for the new time. This calls <code>f(x)</code> or <code>f(x, t)</code> when applicable, where <code>f</code> is the function(s) corresponding to the constraints in the handler, to compute the inhomogeneities.</p><p>Note that this is called implicitly in <code>close!(::ConstraintHandler)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L397-L405">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.apply!" href="#Ferrite.apply!"><code>Ferrite.apply!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply!(K::SparseMatrixCSC, rhs::AbstractVector, ch::ConstraintHandler)</code></pre><p>Adjust the matrix <code>K</code> and right hand side <code>rhs</code> to account for the Dirichlet boundary conditions specified in <code>ch</code> such that <code>K \ rhs</code> gives the expected solution.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p><code>apply!(K, rhs, ch)</code> essentially calculates</p><pre><code class="language-julia hljs">rhs[free] = rhs[free] - K[constrained, constrained] * a[constrained]</code></pre><p>where <code>a[constrained]</code> are the inhomogeneities. Consequently, the sign of <code>rhs</code> matters (in contrast with <code>apply_zero!</code>).</p></div></div><pre><code class="language-julia hljs">apply!(v::AbstractVector, ch::ConstraintHandler)</code></pre><p>Apply Dirichlet boundary conditions and affine constraints, specified in <code>ch</code>, to the solution vector <code>v</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">K, f = assemble_system(...) # Assemble system
apply!(K, f, ch)            # Adjust K and f to account for boundary conditions
u = K \ f                   # Solve the system, u should be &quot;approximately correct&quot;
apply!(u, ch)               # Explicitly make sure bcs are correct</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The last operation is not strictly necessary since the boundary conditions should already be fulfilled after <code>apply!(K, f, ch)</code>. However, solvers of linear systems are not exact, and thus <code>apply!(u, ch)</code> can be used to make sure the boundary conditions are fulfilled exactly.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L507-L542">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.apply_zero!" href="#Ferrite.apply_zero!"><code>Ferrite.apply_zero!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_zero!(K::SparseMatrixCSC, rhs::AbstractVector, ch::ConstraintHandler)</code></pre><p>Adjust the matrix <code>K</code> and the right hand side <code>rhs</code> to account for prescribed Dirichlet boundary conditions and affine constraints such that <code>du = K \ rhs</code> gives the expected result (e.g. <code>du</code> zero for all prescribed degrees of freedom).</p><pre><code class="nohighlight hljs">apply_zero!(v::AbstractVector, ch::ConstraintHandler)</code></pre><p>Zero-out values in <code>v</code> corresponding to prescribed degrees of freedom and update values prescribed by affine constraints, such that if <code>a</code> fulfills the constraints, <code>a ± v</code> also will.</p><p>These methods are typically used in e.g. a Newton solver where the increment, <code>du</code>, should be prescribed to zero even for non-homogeneouos boundary conditions.</p><p>See also: <a href="#Ferrite.apply!"><code>apply!</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">u = un + Δu                 # Current guess
K, g = assemble_system(...) # Assemble residual and tangent for current guess
apply_zero!(K, g, ch)       # Adjust tangent and residual to take prescribed values into account
ΔΔu = K \ g                # Compute the (negative) increment, prescribed values are &quot;approximately&quot; zero
apply_zero!(ΔΔu, ch)        # Make sure values are exactly zero
Δu .-= ΔΔu                  # Update current guess</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The last call to <code>apply_zero!</code> is only strictly necessary for affine constraints. However, even if the Dirichlet boundary conditions should be fulfilled after <code>apply!(K, g, ch)</code>, solvers of linear systems are not exact. <code>apply!(ΔΔu, ch)</code> can be used to make sure the values for the prescribed degrees of freedom are fulfilled exactly.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L545-L579">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.apply_local!" href="#Ferrite.apply_local!"><code>Ferrite.apply_local!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_local!(
    local_matrix::AbstractMatrix, local_vector::AbstractVector,
    global_dofs::AbstractVector, ch::ConstraintHandler;
    apply_zero::Bool = false
)</code></pre><p>Similar to <a href="#Ferrite.apply!"><code>apply!</code></a> but perform condensation of constrained degrees-of-freedom locally in <code>local_matrix</code> and <code>local_vector</code> <em>before</em> they are to be assembled into the global system.</p><p>When the keyword argument <code>apply_zero</code> is <code>true</code> all inhomogeneities are set to <code>0</code> (cf. <a href="#Ferrite.apply!"><code>apply!</code></a> vs <a href="#Ferrite.apply_zero!"><code>apply_zero!</code></a>).</p><p>This method can only be used if all constraints are &quot;local&quot;, i.e. no constraint couples with dofs outside of the element dofs (<code>global_dofs</code>) since condensation of such constraints requires writing to entries in the global matrix/vector. For such a case, <a href="#Ferrite.apply_assemble!"><code>apply_assemble!</code></a> can be used instead.</p><p>Note that this method is destructive since it, by definition, modifies <code>local_matrix</code> and <code>local_vector</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L1582-L1603">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.apply_assemble!" href="#Ferrite.apply_assemble!"><code>Ferrite.apply_assemble!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_assemble!(
    assembler::AbstractAssembler, ch::ConstraintHandler,
    global_dofs::AbstractVector{Int},
    local_matrix::AbstractMatrix, local_vector::AbstractVector;
    apply_zero::Bool = false
)</code></pre><p>Assemble <code>local_matrix</code> and <code>local_vector</code> into the global system in <code>assembler</code> by first doing constraint condensation using <a href="#Ferrite.apply_local!"><code>apply_local!</code></a>.</p><p>This is similar to using <a href="#Ferrite.apply_local!"><code>apply_local!</code></a> followed by <a href="../assembly/#Ferrite.assemble!"><code>assemble!</code></a> with the advantage that non-local constraints can be handled, since this method can write to entries of the global matrix and vector outside of the indices in <code>global_dofs</code>.</p><p>When the keyword argument <code>apply_zero</code> is <code>true</code> all inhomogeneities are set to <code>0</code> (cf. <a href="#Ferrite.apply!"><code>apply!</code></a> vs <a href="#Ferrite.apply_zero!"><code>apply_zero!</code></a>).</p><p>Note that this method is destructive since it modifies <code>local_matrix</code> and <code>local_vector</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/assembler.jl#L345-L364">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.get_rhs_data" href="#Ferrite.get_rhs_data"><code>Ferrite.get_rhs_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_rhs_data(ch::ConstraintHandler, A::SparseMatrixCSC) -&gt; RHSData</code></pre><p>Returns the needed <a href="#Ferrite.RHSData"><code>RHSData</code></a> for <a href="#Ferrite.apply_rhs!"><code>apply_rhs!</code></a>.</p><p>This must be used when the same stiffness matrix is reused for multiple steps, for example when timestepping, with different non-homogeneouos Dirichlet boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L121-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.apply_rhs!" href="#Ferrite.apply_rhs!"><code>Ferrite.apply_rhs!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_rhs!(data::RHSData, f::AbstractVector, ch::ConstraintHandler, applyzero::Bool=false)</code></pre><p>Applies the boundary condition to the right-hand-side vector without modifying the stiffness matrix.</p><p>See also: <a href="#Ferrite.get_rhs_data"><code>get_rhs_data</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L136-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.RHSData" href="#Ferrite.RHSData"><code>Ferrite.RHSData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RHSData</code></pre><p>Stores the constrained columns and mean of the diagonal of stiffness matrix <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/ConstraintHandler.jl#L111-L115">source</a></section></article><h1 id="Initial-conditions"><a class="docs-heading-anchor" href="#Initial-conditions">Initial conditions</a><a id="Initial-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-conditions" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Ferrite.apply_analytical!" href="#Ferrite.apply_analytical!"><code>Ferrite.apply_analytical!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_analytical!(
    a::AbstractVector, dh::AbstractDofHandler, fieldname::Symbol,
    f::Function, cellset=1:getncells(get_grid(dh)))</code></pre><p>Apply a solution <code>f(x)</code> by modifying the values in the degree of freedom vector <code>a</code> pertaining to the field <code>fieldname</code> for all cells in <code>cellset</code>. The function <code>f(x)</code> are given the spatial coordinate of the degree of freedom. For scalar fields, <code>f(x)::Number</code>, and for vector fields with dimension <code>dim</code>, <code>f(x)::Vec{dim}</code>.</p><p>This function can be used to apply initial conditions for time dependent problems.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This function only works for standard nodal finite element interpolations when the function value at the (algebraic) node is equal to the corresponding degree of freedom value. This holds for e.g. Lagrange and Serendipity interpolations, including sub- and superparametric elements.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/0e9e8eacffd9faa3106a7d78127578db7dce0485/src/Dofs/apply_analytical.jl#L7-L27">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../assembly/">« Assembly</a><a class="docs-footer-nextpage" href="../grid/">Grid &amp; AbstractGrid »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 5 March 2025 16:41">Wednesday 5 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
