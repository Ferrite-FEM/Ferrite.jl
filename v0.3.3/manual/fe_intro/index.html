<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction to FEM · Ferrite.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Ferrite.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li class="is-active"><a class="tocitem" href>Introduction to FEM</a><ul class="internal"><li><a class="tocitem" href="#Strong-format"><span>Strong format</span></a></li><li><a class="tocitem" href="#Weak-format"><span>Weak format</span></a></li><li><a class="tocitem" href="#FE-approximation"><span>FE-approximation</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../degrees_of_freedom/">Degrees of Freedom</a></li><li><a class="tocitem" href="../assembly/">Assembly</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary Conditions</a></li><li><a class="tocitem" href="../grid/">Grid</a></li><li><a class="tocitem" href="../export/">Export</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/heat_equation/">Heat Equation</a></li><li><a class="tocitem" href="../../examples/postprocessing/">Postprocessing</a></li><li><a class="tocitem" href="../../examples/helmholtz/">Helmholtz equation</a></li><li><a class="tocitem" href="../../examples/incompressible_elasticity/">Incompressible Elasticity</a></li><li><a class="tocitem" href="../../examples/hyperelasticity/">Hyperelasticity</a></li><li><a class="tocitem" href="../../examples/threaded_assembly/">Threaded Assembly</a></li><li><a class="tocitem" href="../../examples/plasticity/">von Mises plasticity</a></li><li><a class="tocitem" href="../../examples/transient_heat_equation/">Time Dependent Problems</a></li><li><a class="tocitem" href="../../examples/landau/">Ginzburg-Landau model energy minimization</a></li><li><a class="tocitem" href="../../examples/linear_shell/">Linear shell</a></li><li><a class="tocitem" href="../../examples/quasi_incompressible_hyperelasticity/">Nearly Incompressible Hyperelasticity</a></li><li><a class="tocitem" href="../../examples/ns_vs_diffeq/">Incompressible Navier-Stokes Equations via DifferentialEquations.jl</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../reference/quadrature/">Quadrature</a></li><li><a class="tocitem" href="../../reference/interpolations/">Interpolation</a></li><li><a class="tocitem" href="../../reference/fevalues/">FEValues</a></li><li><a class="tocitem" href="../../reference/dofhandler/">DofHandler</a></li><li><a class="tocitem" href="../../reference/assembly/">Assembly</a></li><li><a class="tocitem" href="../../reference/boundary_conditions/">Boundary Conditions</a></li><li><a class="tocitem" href="../../reference/grid/">Grid &amp; AbstractGrid</a></li><li><a class="tocitem" href="../../reference/export/">Postprocessing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Introduction to FEM</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction to FEM</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Ferrite-FEM/Ferrite.jl/blob/master/docs/src/manual/fe_intro.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Introduction-to-FEM"><a class="docs-heading-anchor" href="#Introduction-to-FEM">Introduction to FEM</a><a id="Introduction-to-FEM-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction-to-FEM" title="Permalink"></a></h1><p>Here we will present a very brief introduction to partial differential equations (PDEs) and to the finite element method (FEM). Perhaps the simplest PDE of all is the (linear) heat equation, also known as the Laplace equation. We will use this equation as a demonstrative example of the method, and demonstrate how we go from the strong format of the equation, to the weak form, and then finally to the discrete FE problem.</p><h2 id="Strong-format"><a class="docs-heading-anchor" href="#Strong-format">Strong format</a><a id="Strong-format-1"></a><a class="docs-heading-anchor-permalink" href="#Strong-format" title="Permalink"></a></h2><p>The strong format of the heat equation may be written as:</p><p class="math-container">\[- \mathbf{\nabla} \cdot \mathbf{q}(u) = b \quad x \in \Omega,\]</p><p>where <span>$u$</span> is the unknown temperature field, <span>$\mathbf{q}$</span> is the heat flux and <span>$b$</span> is an internal heat source. To complete the system of equations we need boundary conditions. There are different types of boundary conditions, but the most common ones are Dirichlet – which means that the solution <span>$u$</span> is known at some part of the boundary, and Neumann – which means that the gradient of the solution, <span>$\mathbf{\nabla}$</span> is known. For example</p><p class="math-container">\[u = u^\mathrm{p} \quad \forall \mathbf{x} \in \Gamma_\mathrm{D},\\
\mathbf{q} \cdot \mathbf{n} = q^\mathrm{p} \quad \forall \mathbf{x} \in \Gamma_\mathrm{N},\]</p><p>i.e. the temperature is presribed to <span>$u^\mathrm{p}$</span> at the Dirichlet part of the boundary, <span>$\Gamma_\mathrm{D}$</span>, and the heat flux is prescribed to <span>$q^\mathrm{p}$</span> at the Neumann part of the boundary, <span>$\Gamma_\mathrm{N}$</span>.</p><p>We also need a constitutive equation which links the temperature field, <span>$u$</span>, to the heat flux, <span>$\mathbf{q}$</span>. The simplest case is to use Fourier&#39;s law</p><p class="math-container">\[\mathbf{q} = -k \mathbf{\nabla}u\]</p><p>where <span>$k$</span> is the conductivity of the material. For simplicity we will consider only constant conductivity <span>$k$</span>.</p><h2 id="Weak-format"><a class="docs-heading-anchor" href="#Weak-format">Weak format</a><a id="Weak-format-1"></a><a class="docs-heading-anchor-permalink" href="#Weak-format" title="Permalink"></a></h2><p>The solution to the equation above is usually calculated from the corresponding weak format. By multiplying the equation with an arbitrary test function <span>$\delta u$</span>, integrating over the domain and using partial integration we obtain the <em>weak form</em>; Find <span>$u \in \mathbb{U}$</span> s.t.</p><p class="math-container">\[\int_\Omega \mathbf{\delta u} \cdot (k \mathbf{u}) \mathrm{d}\Omega =
\int_{\Gamma_\mathrm{N}} \delta u q^\mathrm{p} \mathrm{d}\Gamma +
\int_\Omega \delta u b \mathrm{d}\Omega \quad \forall \delta u \in \mathbb{U}^0\]</p><p>where <span>$\mathbb{U}, \mathbb{U}^0$</span> are function spaces with sufficiently regular functions. It can be shown that the solution to the weak form is identical to the solution to the strong format.</p><h2 id="FE-approximation"><a class="docs-heading-anchor" href="#FE-approximation">FE-approximation</a><a id="FE-approximation-1"></a><a class="docs-heading-anchor-permalink" href="#FE-approximation" title="Permalink"></a></h2><p>We now introduce the finite element approximation <span>$u_h \approx u$</span> as a sum of shape functions, <span>$N_i$</span> and nodal values, <span>$a_i$</span>. We approximate the test function in the same way (known as the Galerkin method):</p><p class="math-container">\[u_\mathrm{h} = \sum_{i=1}^{\mathrm{N}} N_i a_i,\qquad
\delta u_\mathrm{h} = \sum_{i=1}^{\mathrm{N}} N_i \delta a_i\]</p><p>We may now inserted these approximations in the weak format, which results in</p><p class="math-container">\[\sum_i^N \sum_j^N \delta a_i \int_\Omega \mathbf{\nabla} N_i \cdot (k \cdot \mathbf{\nabla} N_j) \mathrm{d}\Omega a_j =
\sum_i^N \delta a_i \int_\Gamma N_i q^\mathrm{p} \mathrm{d}\Gamma +
\sum_i^N \delta a_i \int_\Omega N_i b \mathrm{d}\Omega\]</p><p>Since <span>$\delta u$</span> can be chosen arbitrary, the nodal values <span>$\delta a_i$</span> can be chosen arbitrary. Thus, the equation can be written as a linear system of equations</p><p class="math-container">\[\underline{K}\ \underline{a} = \underline{f}\]</p><p>where <span>$\underline{K}$</span> is the (tangent) stiffness matrix, <span>$\underline{a}$</span> is the solution vector with the nodal values and <span>$\underline{f}$</span> is the force vector. The elements of <span>$\underline{K}$</span> and <span>$\underline{f}$</span> are given by</p><p class="math-container">\[\underline{K}_{ij} =
    \int_\Omega \mathbf{\nabla}N_i \cdot (k \cdot \mathbf{\nabla}N_j) \mathrm{d}\Omega\\

\underline{f}_{i} =
    \int_\Gamma N_i q^\mathrm{p} \mathrm{d}\Gamma + \int_\Omega N_i b \mathrm{d}\Omega\]</p><p>The solution to the system (which in this case is linear) is simply given by inverting the matrix <span>$\underline{K}$</span>. We also need to take care of the Dirichlet boundary conditions, by enforcing the correct nodal values <span>$a_i$</span> to the prescribed values.</p><p class="math-container">\[\underline{a} = \underline{K}^{-1}\ \underline{f}\]</p><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>In practice, the shape functions <span>$N$</span> are only non-zero on parts of the domain <span>$\Omega$</span>. Thus, the integrals are evaluated on sub-domains, called <em>elements</em> or <em>cells</em>. Each cell gives a contribution to the global stiffness matrix and force vector. For a solution of the heat equation, as implemented in <code>Ferrite</code>, check out <a href="../../examples/heat_equation/#Heat-Equation">this thoroughly commented example</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../degrees_of_freedom/">Degrees of Freedom »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Friday 4 February 2022 13:20">Friday 4 February 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
